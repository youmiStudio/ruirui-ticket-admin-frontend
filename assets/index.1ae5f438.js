var De=Object.defineProperty,Ce=Object.defineProperties;var Ve=Object.getOwnPropertyDescriptors;var H=Object.getOwnPropertySymbols;var ke=Object.prototype.hasOwnProperty,Be=Object.prototype.propertyIsEnumerable;var K=(o,m,c)=>m in o?De(o,m,{enumerable:!0,configurable:!0,writable:!0,value:c}):o[m]=c,q=(o,m)=>{for(var c in m||(m={}))ke.call(m,c)&&K(o,c,m[c]);if(H)for(var c of H(m))Be.call(m,c)&&K(o,c,m[c]);return o},W=(o,m)=>Ce(o,Ve(m));var v=(o,m,c)=>new Promise((r,D)=>{var x=f=>{try{C(c.next(f))}catch(V){D(V)}},A=f=>{try{C(c.throw(f))}catch(V){D(V)}},C=f=>f.done?r(f.value):Promise.resolve(f.value).then(x,A);C((c=c.apply(o,m)).next())});import{bL as Q,bM as we,bN as xe,bO as Ae,bP as Ne,d as Se,r as S,c as b,o as Re,w as Ie,e as Ue,h as g,i as R,k as e,l as t,m as a,n as I,al as X,aB as Z,q as P,bV as Me,t as y,bW as $e,a_ as qe,bX as Pe,j as B,au as U,aD as Te,x as J,bn as Le,E as je,bR as Oe,bS as Ge,g as ze,bZ as He,bh as Ke,_ as We}from"./index.f2f4e5af.js";import{E as Xe,a as Ze}from"./radio.94706b80.js";import{_ as Je}from"./index.vue_vue_type_script_setup_true_lang.6823ec51.js";import{E as Qe}from"./card.2dd1dae5.js";import{_ as Ye}from"./index.fac30f52.js";import{_ as ea}from"./index.68adca3c.js";import{E as aa}from"./image-viewer.3fecd8e6.js";import{E as ta,a as la}from"./form-item.24d4e3f5.js";import{E as ua,a as oa}from"./col.f1267745.js";import{u as sa}from"./useDictTypes.39a9cb05.js";import{v as na}from"./index.06d45199.js";import ra from"./index.c0459cc9.js";import ia from"./PositionView.a5bf39a6.js";import"./empty.ab6a681e.js";const w="/admin/car",ca=o=>v(void 0,null,function*(){return Q({url:w+"/list",params:o})}),da=o=>v(void 0,null,function*(){return Q({url:w+"/"+o})}),ma=o=>v(void 0,null,function*(){return we({url:w,data:o})}),pa=o=>v(void 0,null,function*(){return xe({url:w+"/"+o})}),fa=o=>v(void 0,null,function*(){return Ae({url:w,data:o})}),_a=o=>v(void 0,null,function*(){return Ne(w+"/export",o,`Car_${new Date().getTime()}.xlsx`)}),ga={class:"app-container"},Fa={class:"car-info"},ha={class:"name"},ba={key:0,class:"describe"},ya={key:0},Ea={class:"dialog-footer"},va=Se({__name:"index",props:{checkMode:{type:Boolean,default:!1}},emits:["check"],setup(o,{emit:m}){const c=o,r=S({title:"\u8F66\u8F86",id:"carId",isAsc:"asc",orderByColumn:"car_id",api:{list:ca,get:da,add:ma,remove:pa,edit:fa,export:_a},authorites:{list:"ticket:car:list",get:"ticket:car:query",add:"ticket:car:add",edit:"ticket:car:edit",remove:"ticket:car:remove",export:"ticket:car:export"}}),D=sa(["sys_common_status"]),x=b(),A=b(),C=b(),f=b(!1),V=b(!0),Y=b([]),F=S({carName:"",carNo:"",status:c.checkMode?"0":""}),ee=S({carName:[{required:!0,message:"\u8F66\u8F86\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],carNo:[{required:!0,message:"\u8F66\u724C\u53F7\u7801\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],gallery:[{required:!0,message:"\u5EA7\u4F4D\u56FE\u4E0D\u80FD\u4E3A\u7A7A"}],status:[{required:!0,message:"\u72B6\u6001\u5FC5\u987B\u9009\u62E9",trigger:"blur"}],seatSchemeId:[{required:!0,message:"\u5EA7\u4F4D\u65B9\u6848\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]});let E=b(),n=S({carId:void 0,carName:"",carDescribe:"",gallery:[],seatSchemeId:0,carNo:"",status:"0",remark:""});const h=S({title:"",dialogVisible:!1}),N=b();Re(()=>{_()}),Ie(Y,s=>{ae(s.length)},{deep:!0});const _=Ue(()=>{x.value&&x.value.search(q({},F))},200);function ae(s){if(s>0){V.value=!1;return}V.value=!0}function te(s){return r.api.list(W(q(q({},s),F),{orderByColumn:r.orderByColumn,isAsc:r.isAsc}))}function le(){M(),h.title=`\u6DFB\u52A0${r.title}`,h.dialogVisible=!0}function ue(s){M(),h.title=`\u4FEE\u6539${r.title}`,h.dialogVisible=!0,oe(s[r.id]).then(u=>{Object.keys(n).forEach(p=>{p in u&&(n[p]=u[p])}),E.value=u.seatScheme})}function oe(s){return new Promise((u,p)=>{r.api.get(s).then(d=>{const{data:i}=d;i&&u(i)})})}function se(s){ne(s[r.id]).then(()=>{_(),J.success("\u5220\u9664\u6210\u529F")})}function ne(s){return new Promise((u,p)=>{Le.confirm(`\u786E\u5B9A\u8981\u5220\u9664${r.title}\u7F16\u53F7[${s}]\u7684\u6570\u636E\u9879\u5417\uFF1F`,"\u8B66\u544A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{r.api.remove(s).then(d=>{const{code:i}=d;i===200?u(d):p(d)})}).catch(()=>{})})}function M(){var s;(s=A.value)==null||s.resetFields(),Object.keys(n).forEach(u=>{n[u]=null}),n.gallery=[],n.status="0",E.value=void 0}function re(){var s;(s=C.value)==null||s.resetFields()}function ie(){re(),_()}function ce(){var s;(s=A.value)==null||s.validate(u=>{if(u){f.value=!0;const p=n[r.id]===null;if(!n.gallery)return;n.mainImgUrl=n.gallery[0].original,(p?r.api.add:r.api.edit)(n).then(i=>{const{code:$}=i;if($!==200){f.value=!1;return}_(),M(),h.dialogVisible=!1,f.value=!1,J.success(`${r.title}${p?"\u65B0\u589E":"\u7F16\u8F91"}\u6210\u529F`)})}})}function de(){h.dialogVisible=!1,M()}function me(){N.value=!0}function pe(s){E.value=s,n.seatSchemeId=s.seatSchemeId,N.value=!1}return(s,u)=>{const p=je,d=ta,i=ua,$=Oe,fe=Ge,k=ze,T=oa,L=la,_e=aa,ge=He,Fe=ea,he=Ye,be=Qe,ye=Je,Ee=Xe,ve=Ze,j=Ke;return g(),R("div",ga,[e(be,{class:"mb-10px",shadow:"never"},{default:t(()=>[e(L,{ref_key:"searchFormRef",ref:C,model:a(F)},{default:t(()=>[e(T,{gutter:20},{default:t(()=>[e(i,{span:8},{default:t(()=>[e(d,{label:"\u8F66\u8F86\u540D\u79F0",prop:"carName"},{default:t(()=>[e(p,{modelValue:a(F).carName,"onUpdate:modelValue":u[0]||(u[0]=l=>a(F).carName=l),placeholder:"\u8BF7\u8F93\u5165\u8F66\u8F86\u540D\u79F0",clearable:"",maxlength:"100",onClear:a(_),onChange:a(_)},null,8,["modelValue","onClear","onChange"])]),_:1})]),_:1}),e(i,{span:8},{default:t(()=>[e(d,{label:"\u8F66\u724C\u53F7\u7801",prop:"carNo"},{default:t(()=>[e(p,{modelValue:a(F).carNo,"onUpdate:modelValue":u[1]||(u[1]=l=>a(F).carNo=l),placeholder:"\u8BF7\u8F93\u5165\u8F66\u724C\u53F7\u7801",clearable:"",maxlength:"10",onClear:a(_),onChange:a(_)},null,8,["modelValue","onClear","onChange"])]),_:1})]),_:1}),o.checkMode?P("",!0):(g(),I(i,{key:0,span:8},{default:t(()=>[e(d,{label:"\u72B6\u6001",prop:"status"},{default:t(()=>[e(fe,{class:"w100%",modelValue:a(F).status,"onUpdate:modelValue":u[2]||(u[2]=l=>a(F).status=l),placeholder:"\u8F66\u8F86\u72B6\u6001",onChange:a(_)},{default:t(()=>[e($,{label:"\u5168\u90E8",value:""}),(g(!0),R(X,null,Z(a(D).type.sys_common_status,l=>(g(),I($,{label:l.label,value:l.value,key:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),_:1})]),_:1})),e(i,{span:6},{default:t(()=>[e(d,null,{default:t(()=>[e(k,{type:"primary",icon:a(Me),onClick:a(_)},{default:t(()=>[y("\u67E5\u8BE2")]),_:1},8,["icon","onClick"]),e(k,{icon:a($e),onClick:ie},{default:t(()=>[y("\u91CD\u7F6E")]),_:1},8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),o.checkMode?P("",!0):(g(),I(T,{key:0,gutter:10},{default:t(()=>[e(i,{span:1.5},{default:t(()=>[qe((g(),I(k,{type:"primary",plain:"",size:"small",icon:a(Pe),onClick:le},{default:t(()=>[y("\u65B0\u589E")]),_:1},8,["icon"])),[[a(na),[a(r).authorites.add]]])]),_:1},8,["span"])]),_:1})),e(he,{ref_key:"tableRef",ref:x,url:te,authority:{edit:[a(r).authorites.edit],delete:[a(r).authorites.remove]},"show-delete":!o.checkMode,"show-setting":!o.checkMode,onEdit:ue,onDelete:se,onClick:u[3]||(u[3]=l=>m("check",l))},{default:t(({element:l})=>[B("div",null,[e(_e,{src:l.mainImgUrl},null,8,["src"]),B("div",Fa,[e(ge,{class:"mr-5px",type:"warning"},{default:t(()=>[y(U(l.carNo),1)]),_:2},1024),e(Fe,{style:{display:"inline-block"},options:a(D).type.sys_common_status,value:l.status},null,8,["options","value"]),B("div",ha,U(l.carName),1),l.carDescribe?(g(),R("div",ba,U(l.carDescribe),1)):P("",!0)])])]),_:1},8,["authority","show-delete","show-setting"])]),_:1}),e(j,{class:"dialog-body-scroll",modelValue:a(h).dialogVisible,"onUpdate:modelValue":u[9]||(u[9]=l=>a(h).dialogVisible=l),title:a(h).title,width:"500px","append-to-body":""},{footer:t(()=>[B("span",Ea,[e(k,{onClick:de},{default:t(()=>[y("\u53D6\u6D88")]),_:1}),e(k,{type:"primary",onClick:ce,loading:a(f)},{default:t(()=>[y(" \u786E\u5B9A ")]),_:1},8,["loading"])])]),default:t(()=>[e(L,{ref_key:"formRef",ref:A,model:a(n),rules:a(ee),"label-width":"100px"},{default:t(()=>[e(T,null,{default:t(()=>[e(i,{span:24},{default:t(()=>[e(d,{label:"\u8F66\u8F86\u540D\u79F0",prop:"carName"},{default:t(()=>[e(p,{modelValue:a(n).carName,"onUpdate:modelValue":u[4]||(u[4]=l=>a(n).carName=l),placeholder:"\u8BF7\u8F93\u5165\u8F66\u8F86\u540D\u79F0",maxlength:"20","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:24},{default:t(()=>[e(d,{label:"\u8F66\u8F86\u56FE\u7247",prop:"gallery"},{default:t(()=>[e(ye,{multiple:"",modelValue:a(n).gallery,"onUpdate:modelValue":u[5]||(u[5]=l=>a(n).gallery=l),idKey:"carGalleryId"},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:24},{default:t(()=>[e(d,{label:"\u8F66\u724C\u53F7\u7801",prop:"carNo"},{default:t(()=>[e(p,{modelValue:a(n).carNo,"onUpdate:modelValue":u[6]||(u[6]=l=>a(n).carNo=l),placeholder:"\u8BF7\u8F93\u5165\u8F66\u724C\u53F7\u7801",maxlength:"10","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{span:24},{default:t(()=>[e(d,{label:"\u5EA7\u4F4D\u65B9\u6848",prop:"seatSchemeId"},{default:t(()=>{var l,O,G,z;return[B("div",null,[a(n).seatSchemeId?(g(),R("div",ya,[e(ia,{image:(l=a(E))==null?void 0:l.carPlaneImage,icon:(O=a(E))==null?void 0:O.unSelectedIcon,positions:(G=a(E))==null?void 0:G.positions},null,8,["image","icon","positions"]),B("span",null,"\u65B9\u6848\u540D\u79F0:"+U((z=a(E))==null?void 0:z.seatSchemeName),1)])):P("",!0),e(k,{type:"primary",onClick:me},{default:t(()=>[y("\u9009\u62E9\u65B9\u6848")]),_:1})])]}),_:1})]),_:1}),e(i,{span:24},{default:t(()=>[e(d,{label:"\u72B6\u6001",prop:"status"},{default:t(()=>[e(ve,{modelValue:a(n).status,"onUpdate:modelValue":u[7]||(u[7]=l=>a(n).status=l)},{default:t(()=>[(g(!0),R(X,null,Z(a(D).type.sys_common_status,l=>(g(),I(Ee,{key:l.value,label:l.value},{default:t(()=>[y(U(l.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(i,{span:24},{default:t(()=>[e(d,{label:"\u8F66\u8F86\u63CF\u8FF0",prop:"carDescribe"},{default:t(()=>[e(p,{"show-word-limit":"",modelValue:a(n).carDescribe,"onUpdate:modelValue":u[8]||(u[8]=l=>a(n).carDescribe=l),placeholder:"\u8F66\u8F86\u63CF\u8FF0",type:"textarea",row:3,maxlength:"100"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),e(j,{class:"dialog-body-p0",modelValue:a(N),"onUpdate:modelValue":u[10]||(u[10]=l=>Te(N)?N.value=l:null),title:"\u9009\u62E9\u5EA7\u4F4D\u65B9\u6848",width:"60%","append-to-body":""},{default:t(()=>[e(ra,{"check-mode":"",onCheck:pe})]),_:1},8,["modelValue"])])}}});const qa=We(va,[["__scopeId","data-v-f4129b73"]]);export{qa as default};
